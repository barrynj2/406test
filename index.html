
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="generator"
    content="HTML Tidy for HTML5 (experimental) for Windows https://github.com/w3c/tidy-html5/tree/c63cc39" />
    <title>FSB Navigation</title>
    <link href="assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen" />
    <link href="assets/bootstrap/css/bootstrap.css" rel="stylesheet" media="screen" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="406webapp" />
    <!-- Font Awesome CSS -->
    <link href="assets/css/font-awesome.min.css" rel="stylesheet" media="screen" />
    <!-- Magnific css -->
    <link href="assets/css/magnific-popup.css" rel="stylesheet" />
    <!-- Custom styles CSS -->
    <link href="assets/css/style.css" rel="stylesheet" media="screen" />
    <!-- Responsive CSS -->
    <link href="assets/css/responsive.css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <meta charset="utf-8" />
    <!--jquery-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--bootstrap-->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- print route script-->
    <script src="assets/js/printRoute.js"></script>
    <!--log in script-->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script type="text/javascript" src="assets/js/drawRoute.js"></script>

    <!--css-->
    <style>
    /* Remove the navbar&amp;#39;s default margin-bottom and rounded borders */
    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }

    /* Set height of the grid so .sidenav can be 100% (adjust as needed) */
    .row.content {height: 1400px;}

    /* Set gray background color and 100% height */
    .sidenav {
      padding-top: 20px;
      background-color: #f1f1f1;
      height: 100%;
    }

    /* Set black background color, white text and some padding */
    footer {
      background-color: #555;
      color: white;
      padding: 15px;
    }

    /* On small screens, set height to &amp;#39;auto&amp;#39; for sidenav and grid */
    @media screen and (max-width: 767px) {
      .sidenav {
        height: auto;
        padding: 15px;
      }
      .row.content {height:auto;}
    }

</style>
  </head>
  <body>
    <!--navbar-->
    <nav class="navbar" style="background-color:#c3142d;">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
              <span class="icon-bar" style="background-color:#fff;"></span>
              <span class="icon-bar" style="background-color:#fff;"></span>
              <span class="icon-bar" style="background-color:#fff;"></span>
            </button>
            <a class="navbar-brand" href="#"><img src="assets/images/image.png" style="height: auto; width:32px;"></a>
          </div>
          <div class="collapse navbar-collapse" id="myNavbar">
            <ul class="nav navbar-nav">
              <li class="active"><a href="https://www.miamioh.edu/" target="_blank">Miami Homepage</a></li>
              <li><a href="https://miamioh.edu/fsb/" target="_blank">FSB Homepage</a></li>
              <li><a href="https://bannerweb.miamioh.edu/" target="_blank">BannerWeb</a></li>
              <li><a href="https://mymiami.miamioh.edu/" target="_blank">MyMiami</a></li>
            </ul>
            <!--
            <ul class="nav navbar-nav navbar-right">
              <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
              <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
            </ul>
          -->
          </div>
        </div>
      </nav>
    <!--end navbar-->
    <!--left section-->
    <div class="container-fluid text-center">
      <div class="row content">
        <div class="col-sm-2 sidenav">
          <h5> Directions: </h5>
            <form><p> Starting Location: <i class="fa fa-map-marker" style="font-size:16px;color:green;"></i></p>
              <select name="start" id="start">
                <!-- <option value="Taylor">Taylor Auditorium (Floor 1)</option>
                <option value="Taylor2">Taylor Auditorium (Floor 2)</option>
                <option value="Front" selected="selected">Front Door</option>
                <option value="Side">Side Door</option> -->
              </select>
              <p>Ending Location: <i class="fa fa-map-marker" style="font-size:16px;color:#c3142d;"></i></p>
              <select name="end" id="end">
                <!-- <option value="Taylor" selected="selected">Taylor Auditorium (Floor 1)</option>
                <option value="Taylor2">Taylor Auditorium (Floor 2)</option>
                <option value="Dividends">Dividends</option>
                <option value="Front">Front Door</option>
                <option value="Side">Side Door</option> -->
              </select>
              <p> Accessibility : <i class="fa fa-wheelchair" style="font-size:16px;"></i></p>
              <select name="stairs" id="access">
                <option value="stairs">Stairs</option>
                <option value="elevator">Elevator</option>
              </select><br/>
              <br/><input type="submit" value="   Go!   " onclick='getRoute(); return false;' /></form>
        </div>
        <!--end left section-->
        <!-- main section-->
        <div id="map" class="col-sm-8 text-center">
          <!--form-->

          <!--form-->
          <br/>
          <!--search by room-->
          <!--
          <form class="form-inline" action="">
            <div class="form-group">
            <label for="search">Search By Room:</label>
            <input type="text" class="form-control" id="search" placeholder="Enter room number..." name="search" /></div>
          </form>
        -->
          <!--end search bar-->

          <!--map-->
          <!--button to switch floors-->
          <div class="container-fluid text-center">
			  <!-- <div id="mapAndRoute" style="background-color:red">
				  <div id="map" style="position:absolute;top:0;left:0;">

			  	  </div>
				  <div id="route" style="position:absolute;top:0;left:0;">
				  </div>
			  <div>
			  <br/> -->
	          <!-- <button class="btn btn-danger btn-xs" onclick="document.getElementById('myImage').src='assets/images/fsb1.png'">Floor 1</button>
	          <button class ="btn btn-danger btn-xs" onclick="document.getElementById('myImage').src='assets/images/fsb2.png'">Floor 2</button> -->
          </div>

          <!--end map-->
          <br />
          <br />
        </div>
        <!--end main section-->
        <!--right section-->
        <div class="col-sm-2 sidenav">
          <div id="login">
            <h5> Log In to BannerWeb to View Courses: </h5> <br/>
            <p>
              Username: <input id="username"></input>
          </p>
          <p>
            Password: <input id="password" type="password"></input>
          </p>
          <button id="getTermCode">Login</button>
          <p id="myClasses">
              Login to see courses!
          </p>
            <br/>
        </div>
          <!--end right section-->
      </div>
    </div>

    <footer class="container-fluid text-center">
      <p>Developed by ISA students &copy;	2018 for support of the Farmer School of </p>
    </footer>
  </body>
  <script type="text/javascript">
    var termCode;
    var token;
    var courses;
    var rooms;
    var validLogin;
    $("#getTermCode").click(function () {
        //clear/initialize all vars
        termCode = "";
        token = "";
        courses = [];
        rooms = [];
        validLogin = true;
        //jQuery for term code
        document.getElementById("username").value
        $.ajax({
            type: "GET",
            url: "https://ws.miamioh.edu/academicTerms/current?applicationname=FSBProject",
            dataType: "xml",
            success: tcParser,
            async: false
        });
        //jQuery for token (requires valid username and password)
        $.ajax({
            type: "POST",
            url: "https://ws.miamioh.edu/authentication",
            data: "type=usernamePassword&application=FSBMobileAppDownload&" + jQuery.param({ username: document.getElementById("username").value, password: document.getElementById("password").value}),
            contentType: 'application/x-www-form-urlencoded',
            dataType: "xml",
            success: tkParser,
            async: false,
            error: invalidCredentials
        })
        if(validLogin){
            //jQuery for course enrollments
            $.ajax({
                type: "GET",
                url: "https://ws.miamioh.edu/enrollments?application=FSBMobileAppDownload&token=" + token,
                dataType: "xml",
                success: crsParser,
                async: false
            })
            //jQuery for course locations (building name + room num)
            for (var i = 0; i < courses.length; i++) {
                $.ajax({
                    type: "GET",
                    url: "https://ws.miamioh.edu/courseSection/" + termCode + "/" + courses[i],
                    dataType: "xml",
                    success: rmParser,
                    async: false
                })
            }
            //Display the rooms
            if(rooms.length > 0) document.getElementById("myClasses").innerHTML = "Courses you are taking in FSB:";
            for(var i = 0; i < rooms.length; i++){
                //The if check is only necessary if we only want to display courses in farmers
                if(rooms[i].startsWith("Farmer School of Business")){
                    document.getElementById("myClasses").innerHTML += "<li>" + rooms[i] + "</li>";
                }
            }

        }
    });
    //Gets the term code
    //Param: xml - the xml file being parsed
    function tcParser(xml) {
        $(xml).find("termId").each(function () {
            termCode = $(this).text();
            //alert(termCode);
        });
    }
    //Gets the token based on a successful login
    //Param: xml - the xml file being parsed
    function tkParser(xml) {
        $(xml).find("token").each(function () {
            token = $(this).text();
            //alert(token);
        })
    }
    //Gets all the courses a student is enrolled in
    //Param: xml - the xml file being parsed
    function crsParser(xml) {
        $(xml).find("courseId").each(function () {
            courses.push($(this).text());
        })
        //alert(courses);
    }
    //Gets all the rooms for the courses a student is taking
    //Param: xml - the xml file being read
    function rmParser(xml) {
        var building = $(xml).find("building").get(0);
        var room = $(xml).find("room").get(0);
        building = building.childNodes[0].nodeValue;
        room = room.childNodes[0].nodeValue;
        rooms.push(building + " " + room);
        console.log(rooms);
    }
    //Lets user know they entered bad data
    function invalidCredentials(){
        validLogin = false;
        alert("Bad username/password");
    }
</script>
</html>
